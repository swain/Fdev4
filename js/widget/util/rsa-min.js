("RSA" in window)||(function(k,l){window.RSA={};var d=window.RSA;var r=2;var f=16;var c=f;var b=1<<16;var B=b>>>1;var o=b*b;var n=b-1;var C=9999999999999998;var p;var m;var v,a;var x=function(D){if(typeof D=="boolean"&&D==true){this.digits=null}else{this.digits=m.slice(0)}this.isNeg=false};d.setMaxDigits=function(E){p=E;m=new Array(p);for(var D=0;D<m.length;D++){m[D]=0}v=new x();a=new x();a.digits[0]=1};d.setMaxDigits(20);var s=15;d.biFromNumber=function(F){var D=new x();D.isNeg=F<0;F=Math.abs(F);var E=0;while(F>0){D.digits[E++]=F&n;F=Math.floor(F/b)}return D};var t=d.biFromNumber(1000000000000000);d.biFromDecimal=function(H){var G=H.charAt(0)=="-";var F=G?1:0;var D;while(F<H.length&&H.charAt(F)=="0"){++F}if(F==H.length){D=new x()}else{var E=H.length-F;var I=E%s;if(I==0){I=s}D=d.biFromNumber(Number(H.substr(F,I)));F+=I;while(F<H.length){D=d.biAdd(d.biMultiply(D,t),d.biFromNumber(Number(H.substr(F,s))));F+=s}D.isNeg=G}return D};d.biCopy=function(E){var D=new x(true);D.digits=E.digits.slice(0);D.isNeg=E.isNeg;return D};d.reverseStr=function(F){var D="";for(var E=F.length-1;E>-1;--E){D+=F.charAt(E)}return D};var z=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];d.biToString=function(F,H){var E=new x();E.digits[0]=H;var G=d.biDivideModulo(F,E);var D=z[G[1].digits[0]];while(d.biCompare(G[0],v)==1){G=d.biDivideModulo(G[0],E);digit=G[1].digits[0];D+=z[G[1].digits[0]]}return(F.isNeg?"-":"")+d.reverseStr(D)};d.biToDecimal=function(F){var E=new x();E.digits[0]=10;var G=d.biDivideModulo(F,E);var D=String(G[1].digits[0]);while(d.biCompare(G[0],v)==1){G=d.biDivideModulo(G[0],E);D+=String(G[1].digits[0])}return(F.isNeg?"-":"")+d.reverseStr(D)};var y=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];d.digitToHex=function(F){var E=15;var D="";for(i=0;i<4;++i){D+=y[F&E];F>>>=4}return d.reverseStr(D)};d.biToHex=function(E){var D="";var G=d.biHighIndex(E);for(var F=d.biHighIndex(E);F>-1;--F){D+=d.digitToHex(E.digits[F])}return D};d.charToHex=function(K){var F=48;var E=F+9;var G=97;var J=G+25;var I=65;var H=65+25;var D;if(K>=F&&K<=E){D=K-F}else{if(K>=I&&K<=H){D=10+K-I}else{if(K>=G&&K<=J){D=10+K-G}else{D=0}}}return D};d.hexToDigit=function(G){var E=0;var D=Math.min(G.length,4);for(var F=0;F<D;++F){E<<=4;E|=d.charToHex(G.charCodeAt(F))}return E};d.biFromHex=function(H){var E=new x();var D=H.length;for(var G=D,F=0;G>0;G-=4,++F){E.digits[F]=d.hexToDigit(H.substr(Math.max(G-4,0),Math.min(G,4)))}return E};d.biFromString=function(L,K){var D=L.charAt(0)=="-";var G=D?1:0;var M=new x();var E=new x();E.digits[0]=1;for(var F=L.length-1;F>=G;F--){var H=L.charCodeAt(F);var I=d.charToHex(H);var J=d.biMultiplyDigit(E,I);M=d.biAdd(M,J);E=d.biMultiplyDigit(E,K)}M.isNeg=D;return M};d.biDump=function(D){return(D.isNeg?"-":"")+D.digits.join(" ")};d.biAdd=function(E,I){var D;if(E.isNeg!=I.isNeg){I.isNeg=!I.isNeg;D=d.biSubtract(E,I);I.isNeg=!I.isNeg}else{D=new x();var H=0;var G;for(var F=0;F<E.digits.length;++F){G=E.digits[F]+I.digits[F]+H;D.digits[F]=G%b;H=Number(G>=b)}D.isNeg=E.isNeg}return D};d.biSubtract=function(E,I){var D;if(E.isNeg!=I.isNeg){I.isNeg=!I.isNeg;D=d.biAdd(E,I);I.isNeg=!I.isNeg}else{D=new x();var H,G;G=0;for(var F=0;F<E.digits.length;++F){H=E.digits[F]-I.digits[F]+G;D.digits[F]=H%b;if(D.digits[F]<0){D.digits[F]+=b}G=0-Number(H<0)}if(G==-1){G=0;for(var F=0;F<E.digits.length;++F){H=0-D.digits[F]+G;D.digits[F]=H%b;if(D.digits[F]<0){D.digits[F]+=b}G=0-Number(H<0)}D.isNeg=!E.isNeg}else{D.isNeg=E.isNeg}}return D};d.biHighIndex=function(E){var D=E.digits.length-1;while(D>0&&E.digits[D]==0){--D}return D};d.biNumBits=function(F){var H=d.biHighIndex(F);var G=F.digits[H];var E=(H+1)*c;var D;for(D=E;D>E-c;--D){if((G&32768)!=0){break}G<<=1}return D};d.biMultiply=function(J,I){var M=new x();var H;var E=d.biHighIndex(J);var L=d.biHighIndex(I);var K,D,F;for(var G=0;G<=L;++G){H=0;F=G;for(j=0;j<=E;++j,++F){D=M.digits[F]+J.digits[j]*I.digits[G]+H;M.digits[F]=D&n;H=D>>>f}M.digits[G+E+1]=H}M.isNeg=J.isNeg!=I.isNeg;return M};d.biMultiplyDigit=function(D,I){var H,G,F;result=new x();H=d.biHighIndex(D);G=0;for(var E=0;E<=H;++E){F=result.digits[E]+D.digits[E]*I+G;result.digits[E]=F&n;G=F>>>f}result.digits[1+H]=G;return result};d.arrayCopy=function(H,K,F,J,I){var D=Math.min(K+I,H.length);for(var G=K,E=J;G<D;++G,++E){F[E]=H[G]}};var h=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];d.biShiftLeft=function(E,K){var G=Math.floor(K/c);var D=new x();d.arrayCopy(E.digits,0,D.digits,G,D.digits.length-G);var J=K%c;var F=c-J;for(var H=D.digits.length-1,I=H-1;H>0;--H,--I){D.digits[H]=((D.digits[H]<<J)&n)|((D.digits[I]&h[J])>>>(F))}D.digits[0]=((D.digits[H]<<J)&n);D.isNeg=E.isNeg;return D};var w=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];d.biShiftRight=function(E,K){var F=Math.floor(K/c);var D=new x();d.arrayCopy(E.digits,F,D.digits,0,E.digits.length-F);var I=K%c;var J=c-I;for(var G=0,H=G+1;G<D.digits.length-1;++G,++H){D.digits[G]=(D.digits[G]>>>I)|((D.digits[H]&w[I])<<J)}D.digits[D.digits.length-1]>>>=I;D.isNeg=E.isNeg;return D};d.biMultiplyByRadixPower=function(E,F){var D=new x();d.arrayCopy(E.digits,0,D.digits,F,D.digits.length-F);return D};d.biDivideByRadixPower=function(E,F){var D=new x();d.arrayCopy(E.digits,F,D.digits,0,D.digits.length-F);return D};d.biModuloByRadixPower=function(E,F){var D=new x();d.arrayCopy(E.digits,0,D.digits,0,F);return D};d.biCompare=function(D,F){if(D.isNeg!=F.isNeg){return 1-2*Number(D.isNeg)}for(var E=D.digits.length-1;E>=0;--E){if(D.digits[E]!=F.digits[E]){if(D.isNeg){return 1-2*Number(D.digits[E]>F.digits[E])}else{return 1-2*Number(D.digits[E]<F.digits[E])}}}return 0};d.biDivideModulo=function(I,H){var D=d.biNumBits(I);var G=d.biNumBits(H);var F=H.isNeg;var N,M;if(D<G){if(I.isNeg){N=d.biCopy(a);N.isNeg=!H.isNeg;I.isNeg=false;H.isNeg=false;M=biSubtract(H,I);I.isNeg=true;H.isNeg=F}else{N=new x();M=d.biCopy(I)}return[N,M]}N=new x();M=I;var K=Math.ceil(G/c)-1;var J=0;while(H.digits[K]<B){H=d.biShiftLeft(H,1);++J;++G;K=Math.ceil(G/c)-1}M=d.biShiftLeft(M,J);D+=J;var Q=Math.ceil(D/c)-1;var V=d.biMultiplyByRadixPower(H,Q-K);while(d.biCompare(M,V)!=-1){++N.digits[Q-K];M=d.biSubtract(M,V)}for(var T=Q;T>K;--T){var L=(T>=M.digits.length)?0:M.digits[T];var U=(T-1>=M.digits.length)?0:M.digits[T-1];var S=(T-2>=M.digits.length)?0:M.digits[T-2];var R=(K>=H.digits.length)?0:H.digits[K];var E=(K-1>=H.digits.length)?0:H.digits[K-1];if(L==R){N.digits[T-K-1]=n}else{N.digits[T-K-1]=Math.floor((L*b+U)/R)}var P=N.digits[T-K-1]*((R*b)+E);var O=(L*o)+((U*b)+S);while(P>O){--N.digits[T-K-1];P=N.digits[T-K-1]*((R*b)|E);O=(L*b*b)+((U*b)+S)}V=d.biMultiplyByRadixPower(H,T-K-1);M=d.biSubtract(M,d.biMultiplyDigit(V,N.digits[T-K-1]));if(M.isNeg){M=d.biAdd(M,V);--N.digits[T-K-1]}}M=d.biShiftRight(M,J);N.isNeg=I.isNeg!=F;if(I.isNeg){if(F){N=d.biAdd(N,a)}else{N=d.biSubtract(N,a)}H=d.biShiftRight(H,J);M=d.biSubtract(H,M)}if(M.digits[0]==0&&d.biHighIndex(M)==0){M.isNeg=false}return[N,M]};d.biDivide=function(D,E){return d.biDivideModulo(D,E)[0]};d.biModulo=function(D,E){return d.biDivideModulo(D,E)[1]};d.biMultiplyMod=function(E,F,D){return d.biModulo(d.biMultiply(E,F),D)};d.biPow=function(E,G){var D=a;var F=E;while(true){if((G&1)!=0){D=d.biMultiply(D,F)}G>>=1;if(G==0){break}F=d.biMultiply(F,F)}return D};d.biPowMod=function(F,I,E){var D=a;var G=F;var H=I;while(true){if((H.digits[0]&1)!=0){D=d.biMultiplyMod(D,G,E)}H=d.biShiftRight(H,1);if(H.digits[0]==0&&d.biHighIndex(H)==0){break}G=d.biMultiplyMod(G,G,E)}return D};BarrettMu=function(D){this.modulus=d.biCopy(D);this.k=d.biHighIndex(this.modulus)+1;var E=new x();E.digits[2*this.k]=1;this.mu=d.biDivide(E,this.modulus);this.bkplus1=new x();this.bkplus1.digits[this.k+1]=1;this.modulo=u;this.multiplyMod=q;this.powMod=e};function u(L){var E=d;var K=E.biDivideByRadixPower(L,this.k-1);var I=E.biMultiply(K,this.mu);var H=E.biDivideByRadixPower(I,this.k+1);var G=E.biModuloByRadixPower(L,this.k+1);var M=E.biMultiply(H,this.modulus);var F=E.biModuloByRadixPower(M,this.k+1);var D=E.biSubtract(G,F);if(D.isNeg){D=E.biAdd(D,this.bkplus1)}var J=E.biCompare(D,this.modulus)>=0;while(J){D=E.biSubtract(D,this.modulus);J=E.biCompare(D,this.modulus)>=0}return D}function q(D,F){var E=d.biMultiply(D,F);return this.modulo(E)}function e(E,H){var D=new x();D.digits[0]=1;var F=E;var G=H;while(true){if((G.digits[0]&1)!=0){D=this.multiplyMod(D,F)}G=d.biShiftRight(G,1);if(G.digits[0]==0&&d.biHighIndex(G)==0){break}F=this.multiplyMod(F,F)}return D}var A=d.RSAKeyPair=function(E,G,D){var F=d;this.e=F.biFromHex(E);this.d=F.biFromHex(G);this.m=F.biFromHex(D);this.chunkSize=2*F.biHighIndex(this.m);this.radix=16;this.barrett=new BarrettMu(this.m)};d.getKeyPair=function(E,F,D){return new A(E,F,D)};function g(D){return(D<10?"0":"")+String(D)}d.encryptedString=function(K,N){var J=[];var D=N.length;var H=0;while(H<D){J[H]=N.charCodeAt(H);H++}while(J.length%K.chunkSize!=0){J[H++]=0}var I=J.length;var O="";var G,F,E;for(H=0;H<I;H+=K.chunkSize){E=new x();G=0;for(F=H;F<H+K.chunkSize;++G){E.digits[G]=J[F++];E.digits[G]+=J[F++]<<8}var M=K.barrett.powMod(E,K.e);var L=K.radix==16?d.biToHex(M):d.biToString(M,K.radix);O+=L+" "}return O.substring(0,O.length-1)};d.decryptedString=function(H,I){var K=I.split(" ");var D="";var G,F,J;for(G=0;G<K.length;++G){var E;if(H.radix==16){E=d.biFromHex(K[G])}else{E=d.biFromString(K[G],H.radix)}J=H.barrett.powMod(E,H.d);for(F=0;F<=d.biHighIndex(J);++F){D+=String.fromCharCode(J.digits[F]&255,J.digits[F]>>8)}}if(D.charCodeAt(D.length-1)==0){D=D.substring(0,D.length-1)}return D};d.setMaxDigits(130);k&&k.add("util-rsa")})(window.jQuery);